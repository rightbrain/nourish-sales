<style>
    @media print {
        .table{
            border: 1px;
            width: 100%;
        }
        .table tr th, .table tr td {
            font-size: 12px !important;
        }
    }
</style>
<h4 style="text-align: center;margin-bottom: 5px">Nourish Poultry & Hatchery Ltd.</h4>
<table width="100%" cellpadding="2px" cellspacing="0" style="margin: 0">
    <tr>
        <td>Feed mill/Depot sale</td>
        <td>
            {% if data['start_date'] is defined %}
                <div style="float: right; text-align: right;"> {{ data['start_date']|date('d-m-Y')}}</div>
            {% endif %}
        </td>
    </tr>
</table>
<table class="table" cellpadding="5px" cellspacing="0" border="1" width="100%">
    <thead>
    <tr>
        <th>Agent Name & Code</th>
        <th>Agent District</th>
        <th>Depot Name</th>
        <th>Total (Kg)</th>
        <th>Value (Tk)</th>
    </tr>
    </thead>
    <tbody>
    {% if deliveries %}
        {% set grandTotalReceived = 0 %}
        {% set grandTotalReceivedValue = 0 %}
        {% set depoName = '' %}
        {% for depotName, results in deliveries %}
            {#                                {% for catName, result in results %}#}
            {% set totalReceived = 0 %}
            {% set totalReceivedValue = 0 %}
            {#                                    {% set depoName = result[0].depoName %}#}
            {% set sl = 1 %}
            {% for delivery in results %}

                <tr>
                    <td>({{ delivery.agentId }}) {{ delivery.agentName }}</td>
                    <td>{{ delivery.zillaName|default('') }}</td>
                    <td>{{ delivery.depoName }}</td>
                    <td style="text-align: right">{{ delivery.totalDeliveredQuantity|number_format(2,'.',',') }}</td>
                    <td style="text-align: right">{{ delivery.totalValue|number_format(2,'.',',') }}</td>
                </tr>
                {% set sl = sl + 1 %}
                {% set totalReceived = totalReceived + delivery.totalDeliveredQuantity %}
                {% set totalReceivedValue = totalReceivedValue + delivery.totalValue %}
            {% endfor %}
            <tr style="font-weight: bold">
                <td style="text-align: center" colspan="2">Total</td>
                <td>{{ depotName }}</td>
                <td style="text-align: right">{{ totalReceived|number_format(2,'.',',') }}</td>
                <td style="text-align: right">{{ totalReceivedValue|number_format(2,'.',',') }}</td>
            </tr>
            {% set grandTotalReceived = grandTotalReceived + totalReceived %}
            {% set grandTotalReceivedValue = grandTotalReceivedValue + totalReceivedValue %}
            {#                                {% endfor %}#}
        {% endfor %}
        <tr style="font-weight: bold">
            <td style="text-align: center" colspan="3">Grand Total</td>
            <td style="text-align: right">{{ grandTotalReceived|number_format(2,'.',',') }}</td>
            <td style="text-align: right">{{ grandTotalReceivedValue|number_format(2,'.',',') }}</td>
        </tr>
    {% else %}
        <tr><td colspan="11">No record found.</td></tr>
    {% endif %}
    </tbody>
</table>
